<!doctype html>
<html>
  <head>
    <title>web worker</title>
  </head>
  <body>
    <h1>WEB Worker</h1>
	<hr/>
	<input type="button" onclick="btn1_action(1)" value="run worker w/mode 1">&nbsp;&nbsp;
	<input type="button" onclick="btn1_action(2)" value="run worker w/mode 2">
	<br /><br />
	<p id="counter">none</p>
	<span id="span1">waiting</span>
	<script>
	  var btn1_action = (m) => {
	    const s = document.getElementById("span1");
            const pp = document.getElementById("counter");
	    s.innerHTML = "running...";
	    pp.innerHTML = "none";
		
	    if (window.Worker) {
		  const w = new Worker("worker/worker.js");
		  w.onmessage = (e) => {
		    s.innerHTML = "in worker thread: " + JSON.stringify(e.data);
		  }
		  w.postMessage({topic:String(m),payload:"12345"});
		  
		  setTimeout(() => {
	            for(let i = 0; i < 10000000; i++) {
		      pp.innerHTML = "in UI thread: " + String(i + 1) + "&nbsp;times";
		    }
		  }, 10);
		} else {
		  s.innerHTML = "the browser is not support web worker."
		}
	  }
	</script>
  </body>
</html>
